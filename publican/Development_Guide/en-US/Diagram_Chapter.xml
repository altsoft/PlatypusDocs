<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "Development_Guide.ent">
%BOOK_ENTITIES;
]>
<chapter id="chap-Development_Guide-Diagram_Chapter">
  <title>Database structure diagram</title>
  <para><emphasis>Database structure diagram</emphasis> is a application element responsible for representation of the database structure. For example, the diagram can specify some part of the knowledge domain. Generally,  the project contains several database structure diagrams at the developer convenience.</para>
  <para>A database structure diagram is a visual representation of the database structure, and it does not directly affect the application functionality.</para>
  <para>The structure of the relational database is determined by the  tables and links between them. Links between two tables are implemented through the foreign keys.</para>
  <note>
    <para>Refer to the publications dedicated to the relational databases for detailed description of specific terms, such as table, foreign key, relation, etc.</para>
  </note>
  <section id="sect-Administration_Guide-Diagram_Chapter-Test_Section_1">
    <title>Creation</title>
    <para>To create a new database structure diagram, perform the following actions:
   
  </para>
    <itemizedlist>
      <listitem>
        <para>Select the  <guimenuitem>New</guimenuitem> item in the parent directory context menu, or select the parent directory and click  <guimenuitem>New File</guimenuitem> in the main menu, or click the  <guibutton>New File</guibutton> button on the toolbar, or use the hotkey.</para>
      </listitem>
      <listitem>
        <para>Select the  <guimenuitem>Database structure diagram</guimenuitem> type in the context menu or select  <menuchoice>
            <guimenu>Choose file type</guimenu>
            <guisubmenu>Platypus application elements</guisubmenu>
            <guimenuitem>Database structure diagram</guimenuitem>
          </menuchoice> on the wizard first step and click <guibutton>Next</guibutton>.</para>
      </listitem>
      <listitem>
        <para>Select the connection to database and database schema:</para>
        <itemizedlist>
          <listitem>
            <para>Select the default database    — click the  <guibutton>Default</guibutton> button or a connection to the external database  — click the  <guibutton>Specific</guibutton> button.</para>
          </listitem>
          <listitem>
            <para>Select a schema in the database in the  <guilabel>Schema</guilabel> drop-down list; click the <guibutton>Default button to select the default schema</guibutton>.</para>
          </listitem>
          <listitem>
            <para>Click <guibutton>Next</guibutton>.</para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para>Specify the name of the new <acronym>database</acronym> structure diagram in the <guilabel>Name</guilabel> field, and click <guibutton>Finish</guibutton> to create a new application element, or click <guibutton>Cancel</guibutton> to cancel.</para>
      </listitem>
    </itemizedlist>
    <para>After creating  the <acronym>database</acronym> structure diagram, build the table structures. To do that, define the fields and their descriptions. After determination of the table structure define  links between the tables.</para>
  </section>
  <section id="sect-Administration_Guide-Diagram_Chapter-Test_Section_2">
    <title>Modification</title>
    <para>A  diagram is a  representation of some  tables in the database, as well as the  links between them. In general, one  includes a part of the database overall structure, which is, for example, related to the certain segment of application functionality. </para>
    <para>A visual designer tool is used for editing  database structure diagrams.</para>
    <para>Visual editor allows you to modify the database structure  — add or delete tables, links between tables, and indexes. The same table can be represented in several diagrams.</para>
    <para>For navigation through a diagram, it is convenient to use the diagram inspector panel. In the inspector,  tables and their fields are represented in the tree structure. When selecting a table or a field in the inspector, the same selection takes place in the diagram editor.</para>
    <para>For mutual positioning of a node in the inspector and an object in the diagram:</para>
    <itemizedlist>
      <listitem>
        <para>Select the  <menuchoice>
            <guimenu>Show in diagram</guimenu>
          </menuchoice> menu item in the inspector&apos;s table node context menu.</para>
      </listitem>
    </itemizedlist>
    <para>To add an existing table to the diagram, perform the following actions:
   
  </para>
    <itemizedlist>
      <listitem>
        <para>Select the <menuchoice>
            <guimenu>Add table</guimenu>
          </menuchoice> menu item  on the editor toolbar, or use the <keycombo>
            <keycap>Ctrl</keycap>
            <keycap>Shift</keycap>
            <keycap>Insert</keycap>
          </keycombo> shortcut.</para>
      </listitem>
      <listitem>
        <para>Select a table in the table selection dialog; if necessary, use the search function. To access it, click  <guibutton>Find</guibutton>.</para>
      </listitem>
      <listitem>
        <para>Click  <guibutton>OK</guibutton> to add the table, or click  <guibutton>Cancel</guibutton> to cancel.</para>
      </listitem>
      <listitem>
        <para>If necessary, drag the table in the diagram to the desired location.</para>
      </listitem>
      <listitem>
        <para>Save the application element by clicking the <guibutton>Save All</guibutton> button on the <application>Platypus Application Designer</application> toolbar, or by pressing the <keycombo>
            <keycap>Ctrl</keycap>
            <keycap>Shift</keycap>
            <keycap>S</keycap>
          </keycombo> shortcut.</para>
      </listitem>
    </itemizedlist>
    <para>To create a new table and to add it to the diagram, perform the following actions:
   
  </para>
    <itemizedlist>
      <listitem>
        <para>Select the  <menuchoice>
            <guimenu>Add table</guimenu>
            <guimenuitem>Create new table</guimenuitem>
          </menuchoice> item in the menu on the editor toolbar.</para>
      </listitem>
      <listitem>
        <para>Specify the name of the new table in the dialog.</para>
      </listitem>
      <listitem>
        <para>Click  <guibutton>OK</guibutton> to add the table, or click  <guibutton>Cancel</guibutton> to cancel.</para>
      </listitem>
      <listitem>
        <para>If necessary, drag the table in the diagram to the desired location.</para>
      </listitem>
      <listitem>
        <para>Save the application element by clicking the <guibutton>Save All</guibutton> button on the Platypus Application Designer toolbar, or by pressing the  <keycombo>
            <keycap>Ctrl</keycap>
            <keycap>Shift</keycap>
            <keycap>S</keycap>
          </keycombo> shortcut.</para>
      </listitem>
    </itemizedlist>
    <note>
      <para>A numeric primary key field  will be automatically created for a  new table.</para>
    </note>
    <para>To remove a table from the diagram, perform the following actions:</para>
    <itemizedlist>
      <listitem>
        <para>Select a table in the diagram.</para>
      </listitem>
      <listitem>
        <para>Click the  <guibutton>Delete</guibutton> button on the editor toolbar.</para>
      </listitem>
      <listitem>
        <para>In the  confirmation dialog, click the <guibutton>Delete from diagram</guibutton> button to remove the table from the diagram (from the diagram only, not from the <acronym>database</acronym>). Click the  <guibutton>Drop table</guibutton> button to remove the table from the database (physical destruction of the table), or click  <guibutton>Cancel</guibutton> to cancel the process.</para>
      </listitem>
      <listitem>
        <para>Save the application element by clicking the <guibutton>Save All</guibutton> button on the <application>Platypus Application Designer</application> toolbar, or by pressing the  <keycombo>
            <keycap>Ctrl</keycap>
            <keycap>Shift</keycap>
            <keycap>S</keycap>
          </keycombo> shortcut.</para>
      </listitem>
    </itemizedlist>
    <para>To add the table fields, perform the following actions: </para>
    <itemizedlist>
      <listitem>
        <para>Select the table in the diagram.</para>
      </listitem>
      <listitem>
        <para>Click the  <guibutton>Create new field/parameter</guibutton> button on the toolbar of the table fields editor tab. The new field dialog appears. Provide the new table field   properties and click <guibutton>OK</guibutton> button to create the new field or <guibutton>Cancel</guibutton> to cancel the process.</para>
      </listitem>
    </itemizedlist>
    <para>Table field properties:</para>
    <itemizedlist>
      <listitem>
        <para><guilabel>name</guilabel> —  field name in the table</para>
      </listitem>
      <listitem>
        <para><guilabel>description</guilabel> — field description</para>
      </listitem>
      <listitem>
        <para><guilabel>type</guilabel> — data type</para>
      </listitem>
      <listitem>
        <para><guilabel>type Name</guilabel> — data structure type name, this field is enabled if the   <parameter>STRUCT</parameter> data type is selected</para>
      </listitem>
      <listitem>
        <para><guilabel>size</guilabel> — field length</para>
      </listitem>
      <listitem>
        <para><guilabel>sclale</guilabel> — field scale or precision</para>
      </listitem>
      <listitem>
        <para><guilabel>nullable</guilabel> — mandatory field (<literal>NULL</literal> values are not allowed).</para>
      </listitem>
    </itemizedlist>
    <informaltable>
      <blockinfo>
        <title>Fields data types in Platypus</title>
      </blockinfo>
      <textobject>
        <para>Параметры режима развертывания</para>
      </textobject>
      <tgroup cols="2">
        <thead>
          <row>
            <entry align="center">Type name</entry>
            <entry align="center">Description</entry>
          </row>
        </thead>
        <tbody>
          <row>
            <entry>
              <parameter>NUMERIC</parameter>
            </entry>
            <entry>Number</entry>
          </row>
          <row>
            <entry>
              <parameter>DECIMAL</parameter>
            </entry>
            <entry>Decimal number</entry>
          </row>
          <row>
            <entry>
              <parameter>VARCHAR</parameter>
            </entry>
            <entry>String with limited length</entry>
          </row>
          <row>
            <entry>
              <parameter>TIMESTAMP</parameter>
            </entry>
            <entry>Date and time</entry>
          </row>
          <row>
            <entry>
              <parameter>DATE</parameter>
            </entry>
            <entry>Date</entry>
          </row>
          <row>
            <entry>
              <parameter>STRUCT</parameter>
            </entry>
            <entry>Structure</entry>
          </row>
          <row>
            <entry>
              <parameter>BLOB</parameter>
            </entry>
            <entry>Binary object with unlimited length</entry>
          </row>
          <row>
            <entry>
              <parameter>CLOB</parameter>
            </entry>
            <entry>String with unlimited length</entry>
          </row>
        </tbody>
      </tgroup>
    </informaltable>
    <para>To edit the field, perform the following actions:</para>
    <itemizedlist>
      <listitem>
        <para>Select the field node among the table daughter nodes in the data model inspector.</para>
      </listitem>
      <listitem>
        <para>Edit the field parameters in the  <guilabel>Properties</guilabel> editor window. </para>
      </listitem>
    </itemizedlist>
    <para>To remove the field, perform the following actions:</para>
    <itemizedlist>
      <listitem>
        <para>Select the table field in the diagram.</para>
      </listitem>
      <listitem>
        <para>Click  <guibutton>Delete</guibutton> on the fields editor toolbar, or use the <keycombo>
            <keycap>Ctrl</keycap>
            <keycap>Delete</keycap>
          </keycombo> shortcut.</para>
      </listitem>
    </itemizedlist>
    <para>To edit the table indexes, use the inspector: open the node of the relevant table, and use the  <guilabel>Indexes</guilabel> node.</para>
    <para>To add a new table index,  perform the following actions:</para>
    <itemizedlist>
      <listitem>
        <para>Select the  <guimenuitem>Add index</guimenuitem> item in the  <guilabel>Indexes</guilabel> node context menu of the corresponding database table.</para>
      </listitem>
      <listitem>
        <para>In the table columns selection dialog, select necessary fields and click <guibutton>OK</guibutton> to add the table index, or click  <guibutton>Cancel</guibutton> to cancel.</para>
      </listitem>
      <listitem>
        <para>If necessary, remove the field from the index using the <guimenuitem>Delete</guimenuitem> item from the index column context menu.</para>
      </listitem>
      <listitem>
        <para>If necessary, modify the order of the fields in the index using the  <guimenuitem>Move up</guimenuitem> and <guimenuitem>Move down</guimenuitem> items from the index column context menu.</para>
      </listitem>
      <listitem>
        <para>If necessary, change  the status of the  <guilabel>Ascending</guilabel> checkbox on the properties panel for the index column, setting the ascending or descending sorting order.</para>
      </listitem>
      <listitem>
        <para>Set the index name in the  <guilabel>Index name</guilabel> field on the index node properties panel.</para>
      </listitem>
      <listitem>
        <para>If necessary, check the  <guilabel>Unique</guilabel> option on the index node properties panel to make the index unique or non-unique.</para>
      </listitem>
      <listitem>
        <para>If necessary, check the  <guilabel>Clustered</guilabel> option  on the index node properties panel to create a clustered index.</para>
      </listitem>
      <listitem>
        <para>If necessary, check the  <guilabel>Hashed</guilabel> option on the index node properties panel to enable or disable hashing for this index.</para>
      </listitem>
    </itemizedlist>
    <para>To modify an table index,  perform the following actions:</para>
    <itemizedlist>
      <listitem>
        <para>Select the index in the table indexes list.</para>
      </listitem>
      <listitem>
        <para>Edit the index; to do that, follow the same steps as when adding a new index.</para>
      </listitem>
    </itemizedlist>
    <para>To delete an index,  perform the following actions:</para>
    <itemizedlist>
      <listitem>
        <para>Select the index among  other child nodes of the relevant table in the inspector.</para>
      </listitem>
      <listitem>
        <para>Select the  <guimenuitem>Delete</guimenuitem> item in the index node context menu.</para>
      </listitem>
    </itemizedlist>
    <para>To add a  foreign key for the table,  perform the following actions:</para>
    <itemizedlist>
      <listitem>
        <para>Using the mouse, drag the field of one table to the primary key field of the other table.</para>
        <para>After that, a foreign key will be created in the database; visually, the link will be represented by the arrow between the tables fields.</para>
      </listitem>
      <listitem>
        <para>Save the application element by clicking the  <guibutton>Save All</guibutton> button on the <application>Platypus Application Designer</application> toolbar, or by using the  <keycombo>
            <keycap>Ctrl</keycap>
            <keycap>Shift</keycap>
            <keycap>S</keycap>
          </keycombo> shortcut.</para>
      </listitem>
    </itemizedlist>
    <important>
      <para>Data types of the fields connected by the foreign key link must be compatible. </para>
    </important>
    <para>To build a hierarchical table structure (unary link), drag the table field to the primary key field of the same table using the mouse.</para>
    <para>To remove the table foreign key,  perform the following actions:</para>
    <itemizedlist>
      <listitem>
        <para>Select the foreign key link using the mouse.</para>
      </listitem>
      <listitem>
        <para>Click the <guibutton>Delete</guibutton> button or use the <keycombo>
            <keycap>Ctrl</keycap>
            <keycap>Delete</keycap>
          </keycombo> shortcut.</para>
      </listitem>
      <listitem>
        <para>Save the application element by clicking the  <guibutton>Save All</guibutton> button on the <application>Platypus Application Designer</application> toolbar, or by using the  <keycombo>
            <keycap>Ctrl</keycap>
            <keycap>Shift</keycap>
            <keycap>S</keycap>
          </keycombo> shortcut.</para>
      </listitem>
    </itemizedlist>
    <note>
      <para>When working in a developers team, after modification of the <acronym>database</acronym> structure, it is recommended to create a migration — a database metadata snapshot, and make it available for all participants of the development process in order to apply the modifications to the rest of the <acronym>database</acronym> copies engaged in the development process.</para>
    </note>
    <para>To query the data from the table,  perform the following actions:</para>
    <itemizedlist>
      <listitem>
        <para>Select the table in the diagram.</para>
      </listitem>
      <listitem>
        <para>Click the  <guibutton>Query Table Data</guibutton> button on the local toolbar — the data will be requested from the table, and the results will be displayed in the editor&apos;s output area.</para>
      </listitem>
    </itemizedlist>
    <para>To modify the size of the database structure diagram visual representation,  perform the following actions:</para>
    <itemizedlist>
      <listitem>
        <para>Click the  <guibutton>Zoom In</guibutton> button to scale up, or  <guibutton>Zoom out</guibutton> button to scale down the representation of the database structure in the editor.</para>
      </listitem>
    </itemizedlist>
    <para>To search through the diagram,  perform the following actions:</para>
    <itemizedlist>
      <listitem>
        <para>Click  <guibutton>Find</guibutton> to open the diagram search dialog.</para>
      </listitem>
      <listitem>
        <para>Specify the search string. </para>
      </listitem>
      <listitem>
        <para>Select  fields to be searched through: <guilabel>Datasets</guilabel>, <guilabel>Fields</guilabel>, <guilabel>Params</guilabel>, and check (uncheck) the following options: <guilabel>Whole words</guilabel> — to search for whole words, <guilabel>Match case</guilabel> — to perform a case-sensitive search. </para>
      </listitem>
      <listitem>
        <para>Click  <guibutton>Next</guibutton> and <guibutton>Previous</guibutton> buttons to go to the next found entity. </para>
      </listitem>
      <listitem>
        <para>Click  <guibutton>Close</guibutton> to close the search dialog. </para>
      </listitem>
    </itemizedlist>
  </section>
</chapter>
