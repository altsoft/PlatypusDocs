<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "Administration_Guide.ent">
%BOOK_ENTITIES;
]>
<chapter id="chap-Administration_Guide-Client_Chapter" lang="ru-RU">
	<!--  This document was created with Syntext Serna Free.  --> <title>Конфигурирование и запуск клиента Platypus</title>
	 <para>
		Клиент Platypus является Java SE программой и предназначен для организации интерфейса пользователя и/или исполнения логики приложения на компьютере конечного пользователя. Клиент Platypus загружает требуемые элементы приложения с сервера приложений, из базы данных или читает непосредственно с диска, из папки, указанной при конфигурировании.
	</para>
	 <para>
		Клиент Platypus обеспечивает автоматическую проверку обновлений и предлагает из установку.
	</para>
	 <section id="sect-Installation_Guide-Test_Chapter-Test_Section_1">
		<title>Режимы работы клиента Platypus</title>
		 <para>
			Клиент Platypus может работать в следующих режимах:
		</para>
		 <itemizedlist>
			<listitem>
				<para>
					2-х звенный режим - Java SE клиент подключается непосредственно к серверу БД. Данная схема рекомендуется для относительно несложных приложений, не требующих исполнения бизнес-логики на сервере.
				</para>
				 <figure>
					<title>2-х звенная схема в Platypus</title>
					 <mediaobject>
						<imageobject>
							<imagedata align="center" fileref="images/2-tiers.png" format="PNG" />
						</imageobject>

					</mediaobject>

				</figure>

			</listitem>
			 <listitem>
				<para>
					автономный 3-х звенный режим - клиент подключается к серверу <application> Platypus Application Server</application>. Для передачи данных используется двоичный протокол Platypus Protocol. Сервер приложений в свою очередь взаимодействует с сервером БД. Этот режим рекомендуется для приложений средней сложности, предполагающих исполнение бизнес-логики на сервере приложений.
				</para>
				 <figure>
					<title>Автономный 3-х звенный режим</title>
					 <mediaobject>
						<imageobject>
							<imagedata align="center" fileref="images/3-tiers.png" format="PNG" />
						</imageobject>

					</mediaobject>

				</figure>

			</listitem>
			 <listitem>
				<para>
					режим сервлета - клиент подключается к сервлет-контейнеру или J2EE серверу , где развернуты серверные компоненты Platypus. Клиентом в данном случае может являться как Java SE клиент, так и HTML5 браузер (Chrome, Opera, Firefox и т.д.). Для передачи данных используется протокол HTTP/HTTPS. В этом случае, для подключения к базам данных используется ресурс источника данных, предоставляемого контейнером. Для данного варианта подключения требуется развертывание серверных компонентов Platypus в сервлет-контейнер или J2EE сервер.
				</para>
				 <figure>
					<title>Режим сервлета Platypus</title>
					 <mediaobject>
						<imageobject>
							<imagedata align="center" fileref="images/3-tiers-j2ee.png" format="PNG" />
						</imageobject>

					</mediaobject>

				</figure>

			</listitem>

		</itemizedlist>

	</section>
	
	 <section id="sect-Administration_Guide-Client_Chapter-Test_Section_2">
		<title>Запуск клиента</title>
		 <para>
			Для запуска клиента необходимо использовать ярлык <guilabel>Platypus Client</guilabel> на рабочем столе, меню <guilabel>Пуск</guilabel> или запустить стартовый скрипт.
		</para>
		 <para>
			Скрипты запуска и загрузчик клиента Platypus находятся в папке <filename>/run</filename> :
		</para>
		 <itemizedlist>
			<listitem>
				<para>
					<filename>platypus.exe</filename> - для запуска в ОС Windows без создания окна командной строки с предварительным запуском обновления клиента; данная команда обеспечивает корректную работу с UAC (User Account Control) в ОС Windows;
				</para>

			</listitem>
			 <listitem>
				<para>
					<filename>platypus.js</filename> - скрипт для запуска в ОС Windows без проверки обновлений;
				</para>

			</listitem>
			 <listitem>
				<para>
					<filename>platypus.sh</filename> - для запуска клиента в ОС Linux;
				</para>

			</listitem>
			 <listitem>
				<para>
					<filename>startupdate.sh</filename> - для запуска клиента в ОС Linux с предварительным запуском обновления клиента;
				</para>

			</listitem>

		</itemizedlist>
		 <para>
			При успешном запуске, клиент выводит диалоговое окно для ввода имени пользователя и пароля и выбора предварительно настроенного подключения к серверу.
		</para>
		 <para>
			Вы можете создать и использовать несколько предварительно настроенных подключений к БД или серверу Platypus. В ваш дистрибутив может быть включено предварительно настроенное подключение по умолчанию.
		</para>
		 <para>
			В случае работы по 2-х звенной схеме введите имя пользователя и пароль соединения с базой данных, а также имя пользователя и пароль в приложениях Platypus.
		</para>
		 <para>
			В случае работы по одной из 3-х звенной схеме введите только имя пользователя и пароль приложений Platypus.
		</para>
		 <para>
			Используйте флажки <guilabel>Запомнить пароль БД</guilabel> и <guilabel>Запомнить пароль</guilabel>, если необходимо запомнить пароль БД и/или пароль приложений Platypus.
		</para>
		 <para>
			Используйте кнопку <guilabel>&gt;&gt;&gt;</guilabel> и <guilabel>&lt;&lt;&lt;</guilabel> для того чтобы отобразить и скрыть панель предварительно настроенных подключений.
		</para>
		 <para>
			Выберите предварительно настроенное подключение из списка для того чтобы подключиться к серверу и запустить клиента.
		</para>
		 <para>
			Создание и редактирование предварительно настроенных подключений.
		</para>
		 <para>
			Для того, чтобы отобразить диалог создания нового подключения нажмите кнопку <guibutton>Новое</guibutton> на панели предварительно настроенных подключений.
		</para>
		 <para>
			Для того, чтобы изменить предварительно настроенное подключение выберите его из списка и нажмите кнопку <guibutton>Изменить</guibutton> на панели предварительно настроенных подключений.
		</para>
		 <para>
			Введите или измените следующие поля диалога "Настройки соединения":
		</para>
		 <itemizedlist>
			<listitem>
				<para>
					<guilabel>Наименование</guilabel> - наименование подключения, например, <literal>myserver</literal>. В данном поле может быть введено любое название;
				</para>

			</listitem>
			 <listitem>
				<para>
					<guilabel>URL подключения</guilabel> - строка соединения с сервером, для работы по 2х звенной схеме должна быть в формате JDBC URL, например: <literal>jdbc:oracle:thin:@dbhost:1521:adb</literal>,
				</para>
				 <para>
					для работы по 3-х звенной схеме по протоколу Platypus Protocol используйте URL формата <literal> platypus://<replaceable>host</replaceable><replaceable>:port</replaceable></literal>, например, <literal>platypus://serverhost:8500</literal>, порт 8500 является портом по умолчанию для протокола Platypus, и его можно в данном случае не указывать,
				</para>
				 <para>
					для работы по 3-х звенной схеме по протоколу HTTP используйте URL формата <literal>http://<replaceable>host</replaceable><replaceable>:port/platypus_servlet/application</replaceable></literal>, например, <literal>http://localhost/myapp/application</literal>.
				</para>

			</listitem>
			 <listitem>
				<para>
					<guilabel>Схема</guilabel> - схема БД по умолчанию, например, <literal>myschema</literal>; В случае 3-х звенного подключения не используется.
				</para>

			</listitem>
			 <listitem>
				<para>
					<guilabel>Пользователь БД</guilabel> - имя пользователя БД по умолчанию, например, <literal>user1</literal>;В случае 3-х звенного подключения не используется.
				</para>

			</listitem>
			 <listitem>
				<para>
					Для сохранения новых настроек подключения нажмите кнопку <guibutton>ОК</guibutton> диалога. Для отмены кнопку <guibutton>Отмена</guibutton>.
				</para>

			</listitem>

		</itemizedlist>
		 <para>
			Для того чтобы удалить предварительно настроенное соединение выберите соединение из списка и нажмите кнопку <guibutton>Удалить</guibutton> на панели предварительно настроенных соединений. Подключение будет удалено после того как пользователь нажмет кнопку <guibutton>ОК</guibutton> в диалоге подтверждения удаления.
		</para>
		 <para>
			Для запуска клиента с выбранным подключением нажмите кнопку <guibutton>ОК</guibutton>. Для того, чтобы закрыть диалог выбора подключений нажмите кнопку <guibutton>Отмена</guibutton>.
		</para>
		 <para>
			После запуска клиента будет запущен элемент приложения по умолчанию (форма, отчет или модуль) для данного пользователя или элемент приложения явно указанный в параметре <parameter>-appElement</parameter> командной строки запуска.
		</para>

	</section>
	
	 <section>
		<title>Настройка скриптов и параметры командной строки запуска клиента</title>
		 <para>
			Данный раздел содержит подробную справочную информацию по параметрам командной строки запуска клиента Platypus.
		</para>
		 <para>
			Для настройки запуска клиента Platypus отредактируйте содержимое файлов скриптов запуска. Могут быть настроены следующие параметры:
		</para>
		 <itemizedlist>
			<listitem>
				<para>
					элемент приложения по умолчанию - идентификатор формы, отчета или модуля который будет открыт при запуске клиента, например <literal>appStartForm</literal>, в случае, если этот параметр не будет указан, клиент будет использовать элемент по умолчанию для текущего пользователя;
				</para>

			</listitem>
			 <listitem>
				<para>
					тема оформления (LaF - Look and Feel) внешнего вида клиента. Клиент Platypus может использовать LaF графической оболочки Swing платформы Java SE. Допустимо использовать как стандартные LaF для данной операционной системы так и библиотечные от сторонних производителей;
				</para>

			</listitem>
			 <listitem>
				<para>
					уровень настройки логов и файл записи логов.
				</para>

			</listitem>

		</itemizedlist>
		 <para>
			Команда для запуска клиента Platypus имеет следующий вид:
		</para>
		 
<programlisting>java -cp Application.jar;<replaceable>EXT_CLASSPATH</replaceable>com.eas.client.application.PlatypusClientApplication <replaceable>OPTIONS</replaceable></programlisting>
		 <para>
			где <replaceable>EXT_CLASSPATH</replaceable> - пути, которые должны быть добавлены в путь поиска загрузчика классов Java, <replaceable>OPTIONS</replaceable> - дополнительные параметры запуска.
		</para>
		 <para>
			В начале настройки рекомендуется запускать скрипты через командную строку, чтобы увидеть возможные сообщения об ошибках. В случае удачного запуска клиента появится диалог авторизации.
		</para>
		 <para>
			Так же клиента можно запустить с использованием параметра <parameter>-jar</parameter>:
		</para>
		 
<programlisting>java -jar Application.jar <replaceable>OPTIONS</replaceable></programlisting>
		 <para>
			Такой вариант запуска удобен при работе с командной строкой, однако такой подход не позволяет добавлять внешние библиотеки в путь по которому загрузчик Java ищет классы, например, для того чтобы подключать произвольные темы оформления Look and Feel.
		</para>
		 <table>
			<title>Параметры запуска клиента из командной строки</title>
			 <tgroup cols="2">
				<tbody>
					<row>
						<entry>
							Параметр
						</entry>
						 <entry>
							Описание
						</entry>

					</row>
					 <row>
						<entry>
							<parameter>-appElement APP_ELEMENT</parameter>
						</entry>
						 <entry>
							Идентификатор элемента приложения для запуска.
						</entry>

					</row>
					 <row>
						<entry>
							<parameter>-ap APP_PATH</parameter>
						</entry>
						 <entry>
							Путь к папке, содержащей элементы приложения Platypus. Если этот параметр задан, то клиент Platypus будет искать элементы приложения Platypus в этой папке, в противном случае клиент Platypus будет искать элементы приложения в базе данных в соотвтествующих таблицах.
						</entry>

					</row>
					 <row>
						<entry>
							<parameter>-url JDBC_URL</parameter>
						</entry>
						 <entry>
							URL соеденения с БД в формате JDBC.
						</entry>

					</row>
					 <row>
						<entry>
							<parameter>-dbuser DB_USER</parameter>
						</entry>
						 <entry>
							Имя пользователя для авторизации в БД.
						</entry>

					</row>
					 <row>
						<entry>
							<parameter>-dbpassword DB_PASSWORD</parameter>
						</entry>
						 <entry>
							Пароль пользователя для авторизации в БД.
						</entry>

					</row>
					 <row>
						<entry>
							<parameter>-dbschema DB_SCHEMA</parameter>
						</entry>
						 <entry>
							Схема БД.
						</entry>

					</row>
					 <row>
						<entry>
							<parameter>-user USER_NAME</parameter>
						</entry>
						 <entry>
							Имя пользвателя приложения Platypus.
						</entry>

					</row>
					 <row>
						<entry>
							<parameter>-password PASSWORD</parameter>
						</entry>
						 <entry>
							Пароль пользвателя приложения Platypus.
						</entry>

					</row>
					 <row>
						<entry>
							<parameter>-loglevel LOG_LEVEL</parameter>
						</entry>
						 <entry>
							Уровень ведения журнала. Данный параметр указывает минимальный уровень который будет выводится в журнал. Описание уровней журнала смотрите в Приложении A.
						</entry>

					</row>
					 <row>
						<entry>
							<parameter>-log LOG_FILE_PATH</parameter>
						</entry>
						 <entry>
							Имя и путь к файлу журнала.
						</entry>

					</row>

				</tbody>

			</tgroup>

		</table>
		 <para>
			Если параметры настройки соеденения с БД или имя пользвателя и пароль Platypus не заданы будет отображен диалог "Настройки соединения" для ввода этих параметров.
		</para>
		 <para>
			Пример команды запуска клиента Platypus:
		</para>
		 
<programlisting>java -cp Application.jar;CoolLaf.jar -laf CoolLaf com.eas.client.application.PlatypusClientApplication -appElement mainForm</programlisting>
		 <para>
			Пример запуска клиента с использованием параметра <parameter>-jar</parameter>:
		</para>
		 
<programlisting>java -jar Application.jar -appElement mainForm</programlisting>

	</section>

</chapter>

