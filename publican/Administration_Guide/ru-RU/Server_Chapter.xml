<?xml version='1.0' encoding='UTF-8'?>
<!-- This document was created with Syntext Serna Free. --><!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "Administration_Guide.ent">
%BOOK_ENTITIES;
]>
<chapter id="chap-Administration_Guide-Server_Chapter">
  <title>Конфигурирование и запуск сервера приложений Platypus</title>
  <para>Сервер приложений <application>Platypus Application Server</application> предназначен для централизованного выполнения  бизнес-логики и является промежуточным слоем при работе Platypus по 3-х звенной схеме.</para>
  <para>Сервер приложений  может быть развернут автономно или внутри сервелет-контейнера/J2EE сервера.</para>
  <para>3х-звенная схема имеет ряд преимуществ по сравнению с 2-х звенной:</para>
  <itemizedlist>
    <listitem>
      <para>лучшая безопасность в следствии того, что у клиента нет прямого доступа к базе данных и по сети не передается  текст запросов к БД;</para>
    </listitem>
    <listitem>
      <para>лучшая производительность из-за того что бизнес-логика выполняется на сервере;</para>
    </listitem>
    <listitem>
      <para>лучшая сопровождаемость системы;</para>
    </listitem>
    <listitem>
      <para>масштабируемость конечного приложения; </para>
    </listitem>
    <listitem>
      <para>возможность использовать HTML5 браузерного клиента (работа с сервлет-контейнером/J2EE сервером);</para>
    </listitem>
  </itemizedlist>
  <section id="sect-Administration_Guide-Server_Chapter-Test_Section_2">
    <title>Запуск сервера приложений Platypus</title>
    <para>В данном режиме сервер приложений Platypus запускается в собственном процессе и собственной виртуальной машине Java (JVM) .</para>
    <para>Для запуска сервера приложений Platypus необходимо запустить стартовый скрипт.
    </para>
    <para>Скрипт запуска сервера  Platypus находятся в папке
    <filename>/run</filename> :</para>
    <itemizedlist>
      <listitem>
        <para><filename>server.bat</filename> -  для запуска сервера в
        ОС Windows; </para>
      </listitem>
      <listitem>
        <para><filename>server.sh</filename> - для запуска сервера в
        ОС Linux;</para>
      </listitem>
    </itemizedlist>
    <para>Для промышленной эксплуатации сервера приложений Platypus рекомендуется настроить его запуск в качестве службы ОС.</para>
  </section>
  <section>
    <title>Настройка скрипта и параметры командной строки запуска сервера приложений Platypus</title>
    <para>Данный раздел содержит подробную справочную информацию по параметрам командной строки запуска сервера приложений Platypus.</para>
    <para>Для настройки запуска сервера Platypus отредактируйте содержимое  файлов скрипта запуска.  Могут быть настроены следующие параметры:</para>
    <itemizedlist>
      <listitem>
        <para>путь к  приложению Platypus, в этом случае параметры соединения с  БД будут получены из конфигурационного файла;  </para>
      </listitem>
      <listitem>
        <para>параметры соединения с БД;  </para>
      </listitem>
      <listitem>
        <para>сетевые интерфейсы и протоколы;</para>
      </listitem>
      <listitem>
        <para>модули обработки входящих данных и фоновых задач;</para>
      </listitem>
      <listitem>
        <para>уровень  логов  и файл записи  логов.</para>
      </listitem>
    </itemizedlist>
    <para>Для настройки отредактируйте переменные и параметры строки запуска скрипта. </para>
    <para>Команда для запуска клиента имеет следующий вид:</para>
    <programlisting>java -cp Server.jar;<replaceable>EXT_CLASSPATH</replaceable> com.eas.server.ServerMain <replaceable>OPTIONS</replaceable></programlisting>
    <para>где <replaceable>EXT_CLASSPATH</replaceable> - пути, которые должны быть добавлены в путь поиска загрузчика классов Java, <replaceable>OPTIONS</replaceable> - дополнительные параметры запуска.</para>
    <para>Так же сервер приложений можно запустить с использованием параметра
    <parameter>-jar</parameter>:</para>
    <programlisting>java -jar Server.jar <replaceable>OPTIONS</replaceable></programlisting>
    <para>Такой вариант запуска удобен, при работе с командной строкой, однако такой подход не позволяет добавлять внешние библиотеки в путь по которому загрузчик Java ищет классы. Например, библиотеки отвечающие за соединение с нетиповыми базами данных или компоненты сторонних производителей, используемые конечным приложением в процессе обработки бизнес-логики.
</para>
    <table>
      <title>Параметры запуска сервера приложений из командной строки</title>
      <tgroup cols="2">
        <thead>
          <row>
            <entry align="center">Параметр</entry>
            <entry align="center">Описание</entry>
          </row>
        </thead>
        <tbody>
          <row>
            <entry>
              <parameter>applicationpath APP_PATH</parameter>
            </entry>
            <entry>Путь к папке, содержащей приложение. Если задан этот параметр, то приложение будет запущено с диска из этой папки, в противном случае приложение будет запущено из базы данных. Этот параметр имеет короткий синоним ap</entry>
          </row>
          <row>
            <entry>
              <parameter>-url JDBC_URL</parameter>
            </entry>
            <entry>URL соеденения с БД в формате JDBC.</entry>
          </row>
          <row>
            <entry>
              <parameter>-dbuser DB_USER</parameter>
            </entry>
            <entry>Имя пользователя для авторизации в БД.</entry>
          </row>
          <row>
            <entry>
              <parameter>-dbpassword DB_PASSWORD</parameter>
            </entry>
            <entry>Пароль пользователя для авторизации в БД.</entry>
          </row>
          <row>
            <entry>
              <parameter>-dbschema DB_SCHEMA</parameter>
            </entry>
            <entry>Схема БД.</entry>
          </row>
          <row>
            <entry><parameter>-iface</parameter><replaceable> ADRESS:PORT</replaceable>,<replaceable>ADRESS:PORT</replaceable></entry>
            <entry>Сетевые интерфейсы и порты прослушивания для сервера.</entry>
          </row>
          <row>
            <entry>
              <parameter>-protocols</parameter>
              <replaceable> PORT:PROTOCOL,PORT:PROTOCOL</replaceable>
            </entry>
            <entry>Сетевые протоколы для портов прослушивания.</entry>
          </row>
          <row>
            <entry>
              <parameter>-loglevel LOG_LEVEL</parameter>
            </entry>
            <entry>Уровень ведения журнала. Данный параметр указывает минимальный уровень который будет выводится в журнал. Описание уровней журнала смотрите в Приложении A.</entry>
          </row>
          <row>
            <entry>
              <parameter>-log LOG_FILE_PATH</parameter>
            </entry>
            <entry>Имя и путь к файлу журнала.</entry>
          </row>
          <row>
            <entry>
              <parameter>-tasks </parameter>
              <replaceable>MODULES_NAME</replaceable>
            </entry>
            <entry>Список серверных модулей (через запятую без пробелов) для обработки входящих данных и фоновых задач. У модуля обработки входящих данных должна быть определена функция <methodname>received(data)</methodname>. Модули обработки входящих данных могут быть как с аннотацией <property>@stateless</property>, так и без нее. У модулей фоновых задач не должно быть аннотации <property>@stateless. При старте сервера, модули с этой аннотацией будут пропущены.</property></entry>
          </row>
        </tbody>
      </tgroup>
    </table>
    <para>Пример команды запуска сервера приложений Platypus:</para>
    <programlisting>java -cp Server.jar com.eas.server.ServerMain -url jdbc:oracle:thin:@serverHost:1521:adb -dbuser user1 -dbpassword secret -loglevel INFO -log serverlog.log -iface 0.0.0.0:8500 -protocols 8500:platypus</programlisting>
    <para>Пример команды запуска сервера приложений с использованием параметра <parameter>-jar</parameter>:    </para>
    <programlisting>java -jar Server.jar -ap ~/apps/testApp -url jdbc:oracle:thin:@serverHost:1521:adb -dbuser user1 -dbpassword secret -loglevel INFO -log serverlog.log</programlisting>
  </section>
</chapter>
